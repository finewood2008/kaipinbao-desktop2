

# ç«å“ç ”ç©¶é˜¶æ®µä¸PRDè¿›åº¦æŒ‡ç¤ºå™¨å®ç°è®¡åˆ’

## é¡¹ç›®æ¦‚è§ˆ

åœ¨PRDå¯¹è¯é˜¶æ®µä¹‹å‰æ·»åŠ "ç«å“ç ”ç©¶"å‰ç½®é˜¶æ®µï¼Œç”¨æˆ·å¯ä»¥æ·»åŠ ç”µå•†å¹³å°äº§å“é“¾æ¥ï¼Œé€šè¿‡FirecrawlæŠ“å–ç«å“ä¿¡æ¯ï¼ˆç‰¹åˆ«æ˜¯è¯„è®ºæ•°æ®ï¼‰ï¼Œä½œä¸ºPRDç»†åŒ–çš„é‡è¦å‚è€ƒã€‚åŒæ—¶ä¸ºPRDé˜¶æ®µæ·»åŠ å¯è§†åŒ–è¿›åº¦æŒ‡ç¤ºå™¨ã€‚

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®åº“æ¶æ„

### 1.1 æ–°å»º `competitor_products` è¡¨

| å­—æ®µå | ç±»å‹ | æè¿° |
|--------|------|------|
| `id` | `uuid` | ä¸»é”® |
| `project_id` | `uuid` | å…³è”é¡¹ç›® |
| `url` | `text` | ç”µå•†å¹³å°é“¾æ¥ |
| `platform` | `text` | å¹³å°ç±»å‹ (amazon/aliexpress/taobaoç­‰) |
| `product_title` | `text` | äº§å“æ ‡é¢˜ |
| `product_description` | `text` | äº§å“æè¿° |
| `price` | `text` | ä»·æ ¼ä¿¡æ¯ |
| `rating` | `decimal` | è¯„åˆ† |
| `review_count` | `integer` | è¯„è®ºæ•°é‡ |
| `scraped_data` | `jsonb` | å®Œæ•´æŠ“å–æ•°æ® |
| `status` | `text` | çŠ¶æ€: pending/scraping/completed/failed |
| `created_at` | `timestamp` | åˆ›å»ºæ—¶é—´ |

### 1.2 æ–°å»º `competitor_reviews` è¡¨

| å­—æ®µå | ç±»å‹ | æè¿° |
|--------|------|------|
| `id` | `uuid` | ä¸»é”® |
| `competitor_product_id` | `uuid` | å…³è”ç«å“ |
| `review_text` | `text` | è¯„è®ºå†…å®¹ |
| `rating` | `integer` | è¯„è®ºè¯„åˆ† |
| `sentiment` | `text` | æƒ…æ„Ÿåˆ†æ: positive/negative/neutral |
| `key_points` | `text[]` | æå–çš„å…³é”®ç‚¹ |
| `is_positive` | `boolean` | æ˜¯å¦æ­£é¢è¯„è®º |
| `created_at` | `timestamp` | åˆ›å»ºæ—¶é—´ |

### 1.3 æ‰©å±• `projects` è¡¨

æ–°å¢å­—æ®µï¼š
- `competitor_research_completed` (boolean): ç«å“ç ”ç©¶æ˜¯å¦å®Œæˆ
- `prd_progress` (jsonb): PRDè¿›åº¦è¿½è¸ªæ•°æ®

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šæµç¨‹è°ƒæ•´

### 2.1 é˜¶æ®µè°ƒæ•´

å°†ç°æœ‰ä¸‰é˜¶æ®µè°ƒæ•´ä¸ºå››é˜¶æ®µï¼š

```text
é˜¶æ®µ 0: ç«å“ç ”ç©¶ (æ–°å¢å‰ç½®é˜¶æ®µ)
   â†“
é˜¶æ®µ 1: PRD ç»†åŒ– (åŸé˜¶æ®µä¸€)
   â†“
é˜¶æ®µ 2: è§†è§‰ç”Ÿæˆ (åŸé˜¶æ®µäºŒ)
   â†“
é˜¶æ®µ 3: è½åœ°é¡µ (åŸé˜¶æ®µä¸‰)
```

æˆ–è€…ä½œä¸ºé˜¶æ®µä¸€çš„å­é˜¶æ®µï¼š

```text
é˜¶æ®µ 1: PRD ç»†åŒ–
  â”œâ”€â”€ 1a: ç«å“ç ”ç©¶ (å¯é€‰)
  â””â”€â”€ 1b: éœ€æ±‚å¯¹è¯
```

**æ¨èæ–¹æ¡ˆ**ï¼šå°†ç«å“ç ”ç©¶ä½œä¸ºé˜¶æ®µ1çš„å‰ç½®æ­¥éª¤ï¼Œä¸æ”¹å˜ç°æœ‰çš„3é˜¶æ®µç»“æ„ï¼Œä¿æŒå…¼å®¹æ€§ã€‚

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šå‰ç«¯ç»„ä»¶

### 3.1 ç«å“ç ”ç©¶ç»„ä»¶

**æ–°å»º `src/components/CompetitorResearch.tsx`**

åŠŸèƒ½ï¼š
- æ·»åŠ ç«å“é“¾æ¥è¾“å…¥æ¡†ï¼ˆæ”¯æŒå¤šä¸ªé“¾æ¥ï¼‰
- å¹³å°è‡ªåŠ¨è¯†åˆ«ï¼ˆAmazon/AliExpress/Taobaoç­‰ï¼‰
- æŠ“å–è¿›åº¦æ˜¾ç¤º
- æŠ“å–ç»“æœå±•ç¤ºï¼ˆäº§å“ä¿¡æ¯ã€è¯„è®ºæ‘˜è¦ï¼‰
- è¯„è®ºæƒ…æ„Ÿåˆ†æå¯è§†åŒ–
- "è·³è¿‡æ­¤æ­¥éª¤"é€‰é¡¹

UI å¸ƒå±€ï¼š
```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” ç«å“ç ”ç©¶ (å¯é€‰)                               â”‚
â”‚ æ·»åŠ ç«äº‰å¯¹æ‰‹äº§å“é“¾æ¥ï¼Œå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°äº†è§£å¸‚åœº        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ”— https://amazon.com/product/xxx          [Ã—]â”‚ â”‚
â”‚ â”‚   âœ… å·²æŠ“å– | Amazon | â˜…4.5 (1,234æ¡è¯„è®º)    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ”— https://aliexpress.com/item/xxx    [æŠ“å–ä¸­]â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                 â”‚
â”‚ [+ æ·»åŠ æ›´å¤šé“¾æ¥]                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š è¯„è®ºåˆ†ææ‘˜è¦                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ‘ å¥½è¯„è¦ç‚¹ (68%)â”‚ ğŸ‘ å·®è¯„è¦ç‚¹ (32%)          â”‚ â”‚
â”‚ â”‚ â€¢ è´¨é‡å¥½         â”‚ â€¢ ç»­èˆªçŸ­                   â”‚ â”‚
â”‚ â”‚ â€¢ è®¾è®¡ç¾è§‚       â”‚ â€¢ å……ç”µæ…¢                   â”‚ â”‚
â”‚ â”‚ â€¢ ä¾¿æºæ€§å¼º       â”‚ â€¢ è¯´æ˜ä¹¦ä¸æ¸…æ™°              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [è·³è¿‡æ­¤æ­¥éª¤]            [å®Œæˆç ”ç©¶ï¼Œå¼€å§‹PRDå¯¹è¯]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 PRDè¿›åº¦æŒ‡ç¤ºå™¨ç»„ä»¶

**æ–°å»º `src/components/PrdProgressIndicator.tsx`**

åŠŸèƒ½ï¼š
- å®æ—¶æ˜¾ç¤ºPRDä¿¡æ¯æ”¶é›†è¿›åº¦
- å¯è§†åŒ–æ˜¾ç¤ºå·²æ”¶é›†/å¾…æ”¶é›†çš„ä¿¡æ¯é¡¹
- ç‚¹å‡»æœªå®Œæˆé¡¹å¯è§¦å‘AIè¿½é—®

è¿›åº¦é¡¹ï¼š
1. â˜‘ ä½¿ç”¨åœºæ™¯å·²æ˜ç¡®
2. â˜‘ ç›®æ ‡ç”¨æˆ·å·²æ˜ç¡®
3. â˜ å¤–è§‚é£æ ¼å·²æ˜ç¡®
4. â˜ æ ¸å¿ƒåŠŸèƒ½å·²æ˜ç¡®
5. â˜ ä¿¡æ¯å·²ç¡®è®¤

UI å¸ƒå±€ï¼š
```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ PRD ä¿¡æ¯æ”¶é›†è¿›åº¦  3/5                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… ä½¿ç”¨åœºæ™¯    âœ… ç›®æ ‡ç”¨æˆ·    â¬œ å¤–è§‚é£æ ¼        â”‚
â”‚ â¬œ æ ¸å¿ƒåŠŸèƒ½    â¬œ ä¿¡æ¯ç¡®è®¤                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60%                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 æ›´æ–° StageIndicator

**ä¿®æ”¹ `src/components/StageIndicator.tsx`**

- ä¸ºé˜¶æ®µ1æ·»åŠ å­è¿›åº¦æŒ‡ç¤º
- æ˜¾ç¤ºç«å“ç ”ç©¶å®ŒæˆçŠ¶æ€

---

## ç¬¬å››éƒ¨åˆ†ï¼šåç«¯ Edge Functions

### 4.1 æ–°å»º Firecrawl æŠ“å–å‡½æ•°

**æ–°å»º `supabase/functions/scrape-competitor/index.ts`**

åŠŸèƒ½ï¼š
1. æ¥æ”¶ç”µå•†å¹³å°URL
2. è°ƒç”¨ Firecrawl API æŠ“å–é¡µé¢å†…å®¹
3. æå–äº§å“ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€ä»·æ ¼ã€è¯„åˆ†ç­‰ï¼‰
4. æå–è¯„è®ºæ•°æ®
5. è°ƒç”¨ AI è¿›è¡Œè¯„è®ºæƒ…æ„Ÿåˆ†æ
6. ä¿å­˜ç»“æœåˆ°æ•°æ®åº“

æ”¯æŒçš„å¹³å°ï¼š
- Amazon (amazon.com, amazon.co.uk, etc.)
- AliExpress
- æ·˜å®/å¤©çŒ« (å°è¯•æŠ“å–)
- é€Ÿå–é€š
- eBay

### 4.2 æ–°å»ºè¯„è®ºåˆ†æå‡½æ•°

**æ–°å»º `supabase/functions/analyze-reviews/index.ts`**

åŠŸèƒ½ï¼š
1. æ¥æ”¶è¯„è®ºæ–‡æœ¬æ•°ç»„
2. ä½¿ç”¨ Gemini è¿›è¡Œæ‰¹é‡åˆ†æ
3. åˆ†ç±»ä¸ºæ­£é¢/è´Ÿé¢
4. æå–å…³é”®ç—›ç‚¹å’Œä¼˜ç‚¹
5. ç”Ÿæˆç»“æ„åŒ–æŠ¥å‘Š

è¾“å‡ºæ ¼å¼ï¼š
```json
{
  "summary": {
    "totalReviews": 50,
    "positivePercent": 68,
    "negativePercent": 32
  },
  "positivePoints": [
    { "point": "è´¨é‡å¥½", "frequency": 25 },
    { "point": "è®¾è®¡ç¾è§‚", "frequency": 18 }
  ],
  "negativePoints": [
    { "point": "ç»­èˆªçŸ­", "frequency": 12 },
    { "point": "å……ç”µæ…¢", "frequency": 8 }
  ],
  "actionableInsights": [
    "ç”¨æˆ·é«˜åº¦é‡è§†äº§å“è´¨é‡å’Œå¤–è§‚",
    "ç»­èˆªæ˜¯ä¸»è¦ç—›ç‚¹ï¼Œå»ºè®®ä½œä¸ºå·®å¼‚åŒ–é‡ç‚¹"
  ]
}
```

### 4.3 æ›´æ–° Chat å‡½æ•°

**ä¿®æ”¹ `supabase/functions/chat/index.ts`**

æ–°å¢åŠŸèƒ½ï¼š
1. æ¥æ”¶ç«å“ç ”ç©¶æ•°æ®ä½œä¸ºä¸Šä¸‹æ–‡
2. åœ¨ç³»ç»Ÿæç¤ºä¸­æ³¨å…¥ç«å“åˆ†æç»“è®º
3. æ ¹æ®å¯¹è¯å†…å®¹å®æ—¶è¿½è¸ªPRDè¿›åº¦
4. è¿”å›è¿›åº¦æ›´æ–°ä¿¡å·

æ–°å¢è¿›åº¦è¿½è¸ªæœºåˆ¶ï¼š
```typescript
// åœ¨AIå›å¤ååˆ†æè¿›åº¦
const progressItems = {
  usageScenario: detectUsageScenario(messages),
  targetAudience: detectTargetAudience(messages),
  designStyle: detectDesignStyle(messages),
  coreFeatures: detectCoreFeatures(messages),
  confirmed: detectConfirmation(messages)
};
```

---

## ç¬¬äº”éƒ¨åˆ†ï¼šFirecrawl é›†æˆ

### 5.1 è¿æ¥ Firecrawl

éœ€è¦é¦–å…ˆé“¾æ¥ Firecrawl connector åˆ°é¡¹ç›®ã€‚

### 5.2 API è°ƒç”¨å°è£…

**æ–°å»º `src/lib/api/firecrawl.ts`**

å°è£… Firecrawl API è°ƒç”¨ï¼š
- `scrapeProduct(url)`: æŠ“å–äº§å“é¡µé¢
- `extractReviews(url)`: æå–è¯„è®ºæ•°æ®

---

## ç¬¬å…­éƒ¨åˆ†ï¼šç”¨æˆ·äº¤äº’æµç¨‹

### 6.1 å®Œæ•´æµç¨‹

```text
ç”¨æˆ·åˆ›å»ºæ–°é¡¹ç›®
        â†“
è¿›å…¥é¡¹ç›®é¡µé¢ (é˜¶æ®µ1)
        â†“
æ˜¾ç¤º"ç«å“ç ”ç©¶"å¡ç‰‡ï¼ˆå¯é€‰æ­¥éª¤ï¼‰
        â†“
ç”¨æˆ·é€‰æ‹©ï¼š
â”œâ”€â”€ [æ·»åŠ ç«å“é“¾æ¥] â†’ ç²˜è´´URL â†’ å¼€å§‹æŠ“å– â†’ æ˜¾ç¤ºç»“æœ
â”‚       â†“
â”‚   [æ·»åŠ æ›´å¤š] æˆ– [å®Œæˆç ”ç©¶]
â”‚       â†“
â”‚   ç«å“æ•°æ®æ³¨å…¥AIä¸Šä¸‹æ–‡
â”‚       â†“
â””â”€â”€ [è·³è¿‡æ­¤æ­¥éª¤]
        â†“
å¼€å§‹PRDå¯¹è¯
â”œâ”€â”€ æ˜¾ç¤ºPRDè¿›åº¦æŒ‡ç¤ºå™¨
â”œâ”€â”€ AIæ ¹æ®ç«å“æ•°æ®è°ƒæ•´æé—®
â””â”€â”€ å®æ—¶æ›´æ–°è¿›åº¦
        â†“
è¿›åº¦è¾¾åˆ°5/5 â†’ æ˜¾ç¤ºé˜¶æ®µå®Œæˆæç¤º
```

### 6.2 PRD è¿›åº¦è¿½è¸ªé€»è¾‘

AI åœ¨æ¯æ¬¡å›å¤ååˆ†æå¯¹è¯å†å²ï¼Œåˆ¤æ–­ä»¥ä¸‹ä¿¡æ¯æ˜¯å¦å·²æ”¶é›†ï¼š

1. **ä½¿ç”¨åœºæ™¯**ï¼šæ£€æµ‹å…³é”®è¯å¦‚"å®¤å†…"ã€"æˆ·å¤–"ã€"å®¶ç”¨"ã€"åŠå…¬"ç­‰
2. **ç›®æ ‡ç”¨æˆ·**ï¼šæ£€æµ‹å¦‚"å¹´è½»äºº"ã€"ç™½é¢†"ã€"å®¶åº­"ç­‰ç”¨æˆ·æè¿°
3. **å¤–è§‚é£æ ¼**ï¼šæ£€æµ‹æè´¨ã€é¢œè‰²ã€å½¢æ€æè¿°
4. **æ ¸å¿ƒåŠŸèƒ½**ï¼šæ£€æµ‹åŠŸèƒ½ç‰¹æ€§æè¿°
5. **ä¿¡æ¯ç¡®è®¤**ï¼šæ£€æµ‹AIçš„æ€»ç»“ç¡®è®¤å›å¤

---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šæŠ€æœ¯å®ç°ç»†èŠ‚

### 7.1 æ–‡ä»¶å˜æ›´åˆ—è¡¨

| æ–‡ä»¶è·¯å¾„ | æ“ä½œ | æè¿° |
|---------|------|------|
| `src/components/CompetitorResearch.tsx` | æ–°å»º | ç«å“ç ”ç©¶ç»„ä»¶ |
| `src/components/PrdProgressIndicator.tsx` | æ–°å»º | PRDè¿›åº¦æŒ‡ç¤ºå™¨ |
| `src/components/CompetitorCard.tsx` | æ–°å»º | å•ä¸ªç«å“å±•ç¤ºå¡ç‰‡ |
| `src/components/ReviewAnalysisSummary.tsx` | æ–°å»º | è¯„è®ºåˆ†ææ‘˜è¦ç»„ä»¶ |
| `src/components/StageIndicator.tsx` | ä¿®æ”¹ | æ·»åŠ å­é˜¶æ®µæ”¯æŒ |
| `src/pages/Project.tsx` | ä¿®æ”¹ | é›†æˆç«å“ç ”ç©¶å’Œè¿›åº¦æŒ‡ç¤ºå™¨ |
| `src/lib/api/firecrawl.ts` | æ–°å»º | Firecrawl APIå°è£… |
| `supabase/functions/scrape-competitor/index.ts` | æ–°å»º | ç«å“æŠ“å–Edge Function |
| `supabase/functions/analyze-reviews/index.ts` | æ–°å»º | è¯„è®ºåˆ†æEdge Function |
| `supabase/functions/chat/index.ts` | ä¿®æ”¹ | æ·»åŠ ç«å“ä¸Šä¸‹æ–‡å’Œè¿›åº¦è¿½è¸ª |
| `supabase/config.toml` | ä¿®æ”¹ | æ³¨å†Œæ–°çš„Edge Functions |
| æ•°æ®åº“è¿ç§» | æ–°å»º | åˆ›å»ºcompetitor_productså’Œcompetitor_reviewsè¡¨ |

### 7.2 Firecrawl æŠ“å–ç­–ç•¥

é’ˆå¯¹ä¸åŒå¹³å°çš„æŠ“å–é…ç½®ï¼š

```typescript
const platformConfigs = {
  amazon: {
    selectors: {
      title: '#productTitle',
      price: '.a-price-whole',
      rating: '.a-icon-star-small',
      reviews: '#cm_cr-review_list .review'
    }
  },
  aliexpress: {
    // AliExpress é…ç½®
  },
  // å…¶ä»–å¹³å°...
};
```

### 7.3 è¿›åº¦è¿½è¸ªç®—æ³•

```typescript
function calculatePrdProgress(messages: Message[]): PrdProgress {
  const allContent = messages.map(m => m.content).join(' ');
  
  return {
    usageScenario: /å®¤å†…|æˆ·å¤–|å®¶ç”¨|åŠå…¬|è½¦è½½|ä¾¿æº/.test(allContent),
    targetAudience: /ç”¨æˆ·|å®¢æˆ·|äººç¾¤|å¹´è½»|ç™½é¢†|å®¶åº­|å­¦ç”Ÿ/.test(allContent),
    designStyle: /æè´¨|é¢œè‰²|é£æ ¼|å¤–è§‚|é‡‘å±|å¡‘æ–™|åœ†æ¶¦|ç¡¬æœ—/.test(allContent),
    coreFeatures: /åŠŸèƒ½|ç‰¹æ€§|ç‰¹ç‚¹|ä¼˜åŠ¿|å–ç‚¹/.test(allContent),
    confirmed: /ç¡®è®¤|æ€»ç»“|æ±‡æ€»|ä»¥ä¸Šä¿¡æ¯/.test(allContent)
  };
}
```

---

## é¢„ä¼°å·¥ä½œé‡

| æ¨¡å— | å¤æ‚åº¦ | æè¿° |
|------|--------|------|
| æ•°æ®åº“è¿ç§» | è½»é‡ | åˆ›å»ºä¸¤ä¸ªæ–°è¡¨ï¼Œæ‰©å±•projectsè¡¨ |
| CompetitorResearchç»„ä»¶ | ä¸­ç­‰ | URLè¾“å…¥ã€çŠ¶æ€ç®¡ç†ã€ç»“æœå±•ç¤º |
| PrdProgressIndicatorç»„ä»¶ | è½»é‡ | è¿›åº¦å¯è§†åŒ– |
| scrape-competitorå‡½æ•° | è¾ƒé‡ | Firecrawlé›†æˆã€å¤šå¹³å°æ”¯æŒ |
| analyze-reviewså‡½æ•° | ä¸­ç­‰ | AIåˆ†æã€ç»“æ„åŒ–è¾“å‡º |
| Chatå‡½æ•°æ›´æ–° | ä¸­ç­‰ | ä¸Šä¸‹æ–‡æ³¨å…¥ã€è¿›åº¦è¿½è¸ª |
| Project.tsxé›†æˆ | ä¸­ç­‰ | ç»„ä»¶é›†æˆã€çŠ¶æ€ç®¡ç† |
| Firecrawlè¿æ¥å™¨é“¾æ¥ | è½»é‡ | ä½¿ç”¨connectå·¥å…· |

